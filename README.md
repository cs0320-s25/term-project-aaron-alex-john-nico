# FINAL PROJECT: FANTASY FOOTBALL DRAFT ASSISTANT

CS logins: 
acaveney, ataoki, jloncke, ndilullo
Github: https://github.com/cs0320-s25/term-project-aaron-alex-john-nico

## Project Details
Fantasy Football drafts are stressful and difficult. Every Year at the start of the NFL season, people spend countless hours trying to look over and review players' stats and abilities to make the best fantasy football rosters possible. Our project aims to provide a draft assistant. By having the user provide which players have been chosen by opposing teams as well as their own players, the assistant will then recommend the next player the user should draft. Our assistant makes use of a neural network as well as a handcrafted algorithm based on our prior experiences in order to provide these recommendations. This assistant will hopefully help save fantasy football enthusiasts time or provide an alternative viewpoint to their draft day decisions.

## Design Choices
We are not planning to offer support for fantasy leagues that don’t use PPR or half-PPR scoring systems. Our web app will be built under the assumption that the league is of standard format, lasting no longer than a year. This will allow us to focus on designing an algorithm that will be of better quality for our intended users. For similar reasons we will also only be supporting the snake draft format.

We recognize that by centering this user group, we are excluding more experienced or niche fantasy football players who participate in alternate formats. While this may limit the project’s flexibility in the short term, it allows us to build a strong foundation for future expansion. Future iterations of the tool could incorporate support for dynasty leagues, auction drafts, or even custom scoring formats.

We utilized ESPN's API to retrieve player data because ESPN is a known, reputable site for sports, in addition to being one of the platforms that provides Fantasy Football. 

For our machine learning algorithm, we trained it using league data from 2024. Our target value to estimate was fantasy ppr, which are essentially fantasy points. We split the league data into and 80-20 split, where 80% of the data was used to train our model, and the last 20% was used to test the model. We then build the results of this model into a dictionary where each position is a key that points to a list of players sorted by their predicted ppr. This dictionary is then saved in the final_standings JSON.

The recommendation algorithm is designed to assemble an optimized fantasy football roster by selecting the highest-value players while adhering to roster constraints. It begins by flattening a dictionary of players generated by the machine learning algorithm, excluding any players already chosen. Players are sorted by our predicted ppr, and the function iteratively selects them, ensuring that the final roster does not exceed the position-specific minimums and maximums defined in POSITION_REQUIREMENTS. To guide smarter roster construction, the function applies simple heuristics, adjusting our predicted score: it adds a bonus to players at underfilled positions and imposes a penalty on players from teams already represented on the roster, promoting positional balance and team diversity.

The algorithm includes safeguards to guarantee all required positions (such as Kicker, Defense, and Tight End) are filled, and it handles the FLEX position by selecting the best available FLEX-eligible player if needed. Once the roster is built, it is sorted by adjusted scores and trimmed to fit the defined roster limit. This approach combines data-driven ranking with practical heuristics to ensure that the final output is not only statistically strong but also strategically sound for fantasy play.

To promote modularity and reusability, each endpoint in our Flask application is defined using a handler factory, a higher-order function like make_handler that returns the actual route handler. This pattern enables easy injection of shared context, such as application state or configuration, without relying on global variables. This design choice keeps the codebase clean, consistent, and easier to maintain as the application scales.


## Bugs/Errors
N/A

## Tests
### Backend Tests
1. test_fetch_all_players: Ensures the /fetch-all-players endpoint returns a non-empty list of player dictionaries with valid data types for required fields.
2. test_get_player_valid: Verifies that querying a valid player by name returns the correct player data.
3. test_get_player_invalid: Confirms that invalid or missing player queries return appropriate error responses (404 or 400).
4. test_add_and_fetch_user_player: Tests that adding a player to the user’s team works and that the player is properly retrievable afterward.
5. test_add_and_fetch_user_player_empty: Ensures the user team can be retrieved even when it's empty, returning a valid list.
6. test_add_and_fetch_opp_player: Checks that adding a player to the opponent’s team works and can be confirmed via fetch.
7. test_add_and_fetch_opp_player_empty: Verifies that the opponent team can be fetched successfully even if it's empty.
8. test_add_fake_player: Confirms that trying to add a non-existent player returns a 404 error.
9. test_add_player_missing_args: Validates that missing query parameters when adding a player result in a 400 error.
10. test_add_and_remove_user_player_roundtrip: Tests the full cycle of adding a player to the user team, verifying their presence, removing them, and confirming availability again.
11. test_add_and_remove_opp_player_roundtrip: Same as above, but for the opponent’s team, ensuring full add/remove functionality.
12. test_remove_missing_args: Ensures that attempting to remove a player without required parameters results in a 400 error.
13. test_remove_fake_player: Confirms that trying to remove a non-existent player returns a 404 error.



## How To


## Collaboration
“Welcome to Flask¶.” Welcome to Flask - Flask Documentation (3.1.x), https://flask.palletsprojects.com/en/stable/. Accessed 18 May 2025. 
Utilized in order to gain a better understanding of Flask and how to setup a server with Flask.

Sankar, Surya. “A Basic App Factory Pattern for Flask Projects.” Medium, Medium, 16 Apr. 2020, https://suryasankar.medium.com/a-basic-app-factory-pattern-for-production-ready-websites-using-flask-and-sqlalchemy-dbb891cdf69f. 
Explains handler factory as well as good practice for setting up a Flask Project.